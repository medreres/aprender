{% extends 'aprender/index.html' %}
{% load static %}
{% block head %}
<link rel="stylesheet" href="{% static 'styles/set.css' %}">
{% if not learnStarted %}
<script>
	function createLearnPath() {
		const idOfSet = url.pathname.substring(url.pathname.lastIndexOf('/') + 1);
		// create set and reload page
		fetch(`${url.origin}/${idOfSet}/createLearnPath`)
			.then(response => {
				location.reload();
			})
	}
</script>
{%endif %}
<script>
	document.addEventListener('DOMContentLoaded', () => {
		currentWord();
	})

	const idOfSet = url.pathname.substring(url.pathname.lastIndexOf('/') + 1);

	function flip(flipCard) {
		flipCard.classList.toggle('flipped');
	}



	function currentWord() {
		fetch(`${path}/sets/${idOfSet}/currentWord`)
			.then(response => response.json())
			.then(result => {
				// go to the next flipcard and change it contexr
				let frontSide = document.querySelector('#carouselItemOneFront');
				frontSide.innerHTML = result['word'];

				let flipSide = document.querySelector('#carouselItemOneBack');
				flipSide.innerHTML = result['definition'];

			})
	}

	function nextWord() {

		fetch(`${path}/sets/${idOfSet}/nextWord`)
			.then(response => response.json())
			.then(result => {
				let nextSlide = document.querySelector('.carousel-item:not(.active)');
				let front = nextSlide.querySelector('.flip-card-front');
				let back = nextSlide.querySelector('.flip-card-back');
				front.innerHTML = result['word'];
				back.innerHTML = result['definition'];
				slideNext();
			})
	}

	function prevWord() {
		fetch(`${path}/sets/${idOfSet}/prevWord`)
			.then(response => response.json())
			.then(result => {
				let nextSlide = document.querySelector('.carousel-item:not(.active)');
				let front = nextSlide.querySelector('.flip-card-front');
				let back = nextSlide.querySelector('.flip-card-back');
				front.innerHTML = result['word'];
				back.innerHTML = result['definition'];
				slidePrev();
			})
	}

	function slideNext() {
		const myCarouselEl = document.querySelector('#carouselExampleInterval')
		const carousel = bootstrap.Carousel.getInstance(myCarouselEl) // Retrieve a Carousel instance
		carousel.next();
	}

	function slidePrev() {
		const myCarouselEl = document.querySelector('#carouselExampleInterval')
		const carousel = bootstrap.Carousel.getInstance(myCarouselEl) // Retrieve a Carousel instance
		carousel.prev();
	}
</script>

{% endblock head %}
{% block body %}
<section class='set'>
	<h1>{{set.label}}</h1>
	<div class="menuContainer">
		<a type="button" class="btn btn-primary" href="{% url 'flashcards' id %}">Flashcards</a>
		<a type="button" class="btn btn-primary" href="{% url 'learn' id %}">Learn</a>
		<!-- <a type="button" class="btn btn-primary" href="{% url 'test' id %}">Test</a> -->
		<!-- Button trigger modal -->
		<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#testModal">
			Test
		</button>
		<style>
			#questionTypes {
				min-height: 100px;
				display: flex;
				flex-flow: column;
			}

			.form-check-label {}

			/* .modal-body {
				display: flex;

			} */



			#starredTerms {
				min-width: 70%;
			}

			.container {
				display: flex;
			}
		</style>
		<!-- Modal -->
		<div class="modal fade" id="testModal" tabindex="-1" aria-labelledby="testModal" aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<form action="{% url 'test' id %}" method='get'>
						<div class="modal-header">
							<h5 class="modal-title" id="testModal">Test settings</h5>
							<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
						</div>
						<div class="modal-body">
							<div class="container">

								<script>
									document.addEventListener('DOMContentLoaded', () => {


										let questionTypes = document.querySelectorAll('input[name=question]');
										console.log(questionTypes)
										questionTypes.forEach(checkbox => {
											checkbox.addEventListener('change', (evt) => {
												let target = evt.target;
												if (target.checked) {
													questionTypes.forEach(input => input.required = false);
												}
												else {
													questionTypes.forEach(input => input.required = true);
												}
											})
										})
									})
								</script>
								<div class="form-check" id='questionTypes'>
									<label class="form-check-label" for="written">
										Written <input class="form-check-input" name="question" type="checkbox"
											value="written" id="written" required>
									</label>

									<label class="form-check-label" for="Matching">
										Matching <input class="form-check-input" name="question" type="checkbox"
											value="matching" id="Matching" required>
									</label>

									<label class="form-check-label" for="multipleChoices">
										Multiple Choices <input class="form-check-input" name="question" type="checkbox"
											value="multiple" id="multipleChoices" required>
									</label>

									<label class="form-check-label" for="trueFalse">
										True/False <input class="form-check-input" name="question" type="checkbox"
											value="trueFalse" id="trueFalse" required>
									</label>
								</div>
								<div id="limitAndImages">
									<div id="questionLimit">
										<label for="">
											Question Limit <input type="number" step="5" min="10" max="50" value="10">
										</label>
									</div>
									<div id="showImages">
										<label for="">Images <input type="checkbox"> </label>
									</div>
								</div>
							</div>
							<div id="starredTerms">
								<label for="">Study Starred Terms
									<div class="btn-group" role="group">
										<input type="radio" name="radio-Btn-Group" class="btn-check" id="radioBtn1">
										<label class="btn btn-outline-warning" for="radioBtn1">All</label>

										<input type="radio" name="radio-Btn-Group" class="btn-check" id="radioBtn2"
											checked>
										<label class="btn btn-outline-success" for="radioBtn2">Starred</label>

									</div>
								</label>
							</div>
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
							<button type="submit" class="btn btn-primary">Start Test</button>
						</div>
					</form>
				</div>
			</div>
		</div>
		<button type="button" class="btn btn-primary">Match</button>
		<hr class="dropdown-divider">
		<!-- carousel for taking look at cards with words -->
		<div id="carouselExampleInterval" class="carousel slide" data-bs-ride="carousel" data-bs-interval="false">
			<div class="carousel-inner">
				<div class="carousel-item active" data-bs-interval="10000" style='height: 400px;'>
					<div class="flip-card" onclick='flip(this);' id="flipCardOne">
						<div class="flip-card-inner">
							<div class="flip-card-front" id='carouselItemOneFront'>
							</div>
							<div class="flip-card-back" id='carouselItemOneBack'>
							</div>
						</div>
					</div>
				</div>
				<div class="carousel-item" data-bs-interval="2000" style='height: 400px;'>
					<div class="flip-card" onclick='flip(this)' id="flipCardTwo">
						<div class="flip-card-inner">
							<div class="flip-card-front" id='carouselItemTwoFront'>
							</div>
							<div class="flip-card-back" id='carouselItemTwoBack'>
							</div>
						</div>
					</div>
				</div>
			</div>
			<button class="carousel-control-prev" type="button" onclick='prevWord();'>
				<span class="carousel-control-prev-icon" aria-hidden="true"></span>
				<span class="visually-hidden">Previous</span>
			</button>
			<button class="carousel-control-next" type="button" onclick='nextWord();'>
				<span class="carousel-control-next-icon" aria-hidden="true"></span>
				<span class="visually-hidden">Next</span>
			</button>
		</div>
		{% if user.is_authenticated and not learnStarted %}
		<!-- blurring div in case learn program hasn't been created yet  -->
		<div class='blur'>
			<p> Opps! It's seems that you haven't create your learning way yet!</p>
			<p>Click <button onclick="createLearnPath();" class="btn bg-primary">Create</button> to start studying term
				right off the bat!</p>
		</div>
		{% elif not user.is_authenticated %}
		<div class='blur'>
			<p> Opps! It's seems that you haven't signed in yet!</p>
			<p>Sign in to start learning words right now!</p>
		</div>
		{% endif %}
	</div>
	<hr class="dropdown-divider">
	<div>
		Created by user, his photo, at the reight icons for adding this set fo a folder, editing the set or sharing
	</div>
	<div>
		here start sections with cards , words on them, pagintaion for 10-15 carcs per page, search bar
		Each card must have word, definitoin, button to add to favorites, edit btn, photo (optional)
	</div>
</section>
{% endblock body %}